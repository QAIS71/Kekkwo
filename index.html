<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Selfie Station</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙˆÙ‚ Ø§Ù„Ù€ 3D */
        #ui-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; /* ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù€ 3D */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ù„ØºØ§Øª */
        .top-bar {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            pointer-events: auto;
        }

        .logo { color: #00d2ff; font-size: 24px; font-weight: bold; text-shadow: 0 0 10px #00d2ff; }
        
        select#language-selector {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid #00d2ff;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
        }

        /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ */
        .controls {
            padding: 30px;
            text-align: center;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .btn {
            background: linear-gradient(45deg, #00d2ff, #3a7bd5);
            border: none;
            padding: 12px 30px;
            color: white;
            font-size: 16px;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 210, 255, 0.5);
            transition: transform 0.2s;
            font-weight: bold;
        }
        .btn:hover { transform: scale(1.05); }
        .btn-secondary { background: #444; box-shadow: none; }

        /* Ù…ÙƒØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (Ù„Ø£Ø±Ø¨Ø§Ø­Ùƒ) */
        .ad-space {
            position: absolute;
            top: 50%; right: 20px;
            transform: translateY(-50%);
            width: 160px; height: 600px;
            background: rgba(255,255,255,0.05);
            border: 1px dashed #555;
            color: #555;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: auto;
        }

        /* Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ */
        input[type="file"] { display: none; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>

    <div id="ui-container">
        <div class="top-bar">
            <div class="logo">ğŸš€ SpaceSelfie</div>
            <select id="language-selector" onchange="changeLanguage()">
                <option value="en">English</option>
                <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="fr">FranÃ§ais</option>
                <option value="es">EspaÃ±ol</option>
                <option value="de">Deutsch</option>
                <option value="zh">Chinese</option>
                </select>
        </div>

        <div class="ad-space">
            Google AdSense Area
        </div>

        <div class="controls">
            <h2 id="instruction-text" style="color: white; text-shadow: 0 2px 4px black;">Upload your photo to space!</h2>
            
            <input type="file" id="imageUpload" accept="image/*">
            <button class="btn" onclick="document.getElementById('imageUpload').click()" id="upload-btn">ğŸ“‚ Upload Photo</button>
            <button class="btn btn-secondary" onclick="takeSnapshot()" id="download-btn">ğŸ“¸ Download High Res</button>
        </div>
    </div>

    <script>
        // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Scene Setup)
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, preserveDrawingBuffer: true }); // preserveDrawingBuffer Ù…Ù‡Ù… Ù„Ù„ØªØ­Ù…ÙŠÙ„
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio); // Ù„Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹
        document.body.appendChild(renderer.domElement);

        // 2. Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© (Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø´Ù…Ø³)
        const ambientLight = new THREE.AmbientLight(0x333333);
        scene.add(ambientLight);
        const sunLight = new THREE.DirectionalLight(0xffffff, 1.5);
        sunLight.position.set(5, 3, 5);
        scene.add(sunLight);

        // 3. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø¬ÙˆÙ… (Starfield)
        const starsGeometry = new THREE.BufferGeometry();
        const starsCount = 5000;
        const posArray = new Float32Array(starsCount * 3);
        for(let i = 0; i < starsCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 100; // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù†Ø¬ÙˆÙ…
        }
        starsGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const starsMaterial = new THREE.PointsMaterial({size: 0.05, color: 0xffffff});
        const starMesh = new THREE.Points(starsGeometry, starsMaterial);
        scene.add(starMesh);

        // 4. Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø±Ø¶ (Earth)
        // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„ÙƒÙŠ ØªÙƒÙˆÙ† ÙˆØ§Ù‚Ø¹ÙŠØ© Ø¬Ø¯Ø§Ù‹ ØªØ­ØªØ§Ø¬ Ø±ÙˆØ§Ø¨Ø· Textures Ø­Ù‚ÙŠÙ‚ÙŠØ©. Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ø£Ù„ÙˆØ§Ù† Ù„ØªÙˆØ¶ÙŠØ­ Ø§Ù„ÙÙƒØ±Ø©.
        const earthGeometry = new THREE.SphereGeometry(2, 64, 64);
        const earthMaterial = new THREE.MeshPhongMaterial({
            map: new THREE.TextureLoader().load('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/planets/earth_atmos_2048.jpg'),
            specular: new THREE.Color('grey'),
            shininess: 10
        });
        const earth = new THREE.Mesh(earthGeometry, earthMaterial);
        scene.add(earth);

        // 5. Ø¥Ù†Ø´Ø§Ø¡ "Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ø·Ø©" (Station Screen)
        // ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù‡Ù†Ø§ Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ù…ÙŠÙ„ Ù…ÙˆØ¯ÙŠÙ„ 3D Ù„Ù„Ù…Ø­Ø·Ø© Ø¨ØµÙŠØºØ© GLTF
        // Ø§Ù„Ø¢Ù† Ø³Ù†ØµÙ†Ø¹ "Ø¥Ø·Ø§Ø±" ÙŠÙ…Ø«Ù„ Ø§Ù„ØªØ§Ø¨Ù„Øª Ø£Ùˆ Ø§Ù„Ø´Ø§Ø´Ø©
        const screenGroup = new THREE.Group();

        // Ø¥Ø·Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø© (Ø§Ù„Ø£Ø³ÙˆØ¯)
        const frameGeo = new THREE.BoxGeometry(1.6, 1, 0.1);
        const frameMat = new THREE.MeshLambertMaterial({ color: 0x111111 });
        const frame = new THREE.Mesh(frameGeo, frameMat);
        screenGroup.add(frame);

        // Ø§Ù„Ø´Ø§Ø´Ø© Ù†ÙØ³Ù‡Ø§ (Ø§Ù„ØªÙŠ Ø³ØªØ¸Ù‡Ø± Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„ØµÙˆØ±Ø©)
        const screenGeo = new THREE.PlaneGeometry(1.5, 0.9);
        const screenMat = new THREE.MeshBasicMaterial({ color: 0x000000 }); // Ø£Ø³ÙˆØ¯ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        const displayScreen = new THREE.Mesh(screenGeo, screenMat);
        displayScreen.position.z = 0.06; // ØªØ¨Ø±Ø² Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ù„Ø£Ù…Ø§Ù…
        screenGroup.add(displayScreen);

        // ÙˆØ¶Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© Ø£Ù…Ø§Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ØªØ¨Ø¯Ùˆ ÙƒØ£Ù†Ù‡Ø§ Ø¯Ø§Ø®Ù„ Ù…Ø­Ø·Ø© ØªØ¯ÙˆØ±
        screenGroup.position.set(0, 0, 3.5); 
        scene.add(screenGroup);

        camera.position.z = 5;

        // 6. Ù…Ù†Ø·Ù‚ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© (Upload Logic)
        const imageUpload = document.getElementById('imageUpload');
        imageUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const imgObj = new Image();
                    imgObj.src = event.target.result;
                    imgObj.onload = function() {
                        const texture = new THREE.Texture(imgObj);
                        texture.needsUpdate = true;
                        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø®Ø§Ù…Ø© Ø§Ù„Ø´Ø§Ø´Ø©
                        displayScreen.material.map = texture;
                        displayScreen.material.color.set(0xffffff); // Ø¬Ø¹Ù„Ù‡Ø§ Ø¨ÙŠØ¶Ø§Ø¡ Ù„ØªØ¸Ù‡Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù†
                        displayScreen.material.needsUpdate = true;
                    };
                };
                reader.readAsDataURL(file);
            }
        });

        // 7. Ø§Ù„ØªØ­Ø±ÙŠÙƒ (Animation Loop)
        function animate() {
            requestAnimationFrame(animate);
            
            // ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø£Ø±Ø¶ Ø¨Ø¨Ø·Ø¡ (ÙˆØ§Ù‚Ø¹ÙŠØ©)
            earth.rotation.y += 0.0005;
            
            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù†Ø¬ÙˆÙ… Ù‚Ù„ÙŠÙ„Ø§Ù‹
            starMesh.rotation.y -= 0.0002;

            // Ø¬Ø¹Ù„ Ø§Ù„Ø´Ø§Ø´Ø© ØªØªØ­Ø±Ùƒ Ø­Ø±ÙƒØ© Ø·ÙÙŠÙØ© ÙƒØ£Ù†Ù‡Ø§ ØªØ³Ø¨Ø­ ÙÙŠ Ø§Ù†Ø¹Ø¯Ø§Ù… Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
            screenGroup.rotation.z = Math.sin(Date.now() * 0.0005) * 0.02;
            screenGroup.position.y = Math.sin(Date.now() * 0.001) * 0.05;

            renderer.render(scene, camera);
        }
        animate();

        // 8. Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Download/Snapshot)
        function takeSnapshot() {
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù€ UI Ù…Ø¤Ù‚ØªØ§Ù‹ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠØŒ Ù‡Ù†Ø§ Ø§Ù„Ù€ UI HTML Ù…Ù†ÙØµÙ„ ÙÙ„Ø§ ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù€ Canvas)
            render(); // Ø±ÙŠÙ†Ø¯Ø± Ù„Ø¶Ù…Ø§Ù† Ø¢Ø®Ø± Ù„Ù‚Ø·Ø©
            const link = document.createElement('a');
            link.download = 'My-Space-Selfie.png';
            // Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹
            link.href = renderer.domElement.toDataURL('image/png', 1.0); 
            link.click();
        }

        function render() {
            renderer.render(scene, camera);
        }

        // Ø¶Ø¨Ø· Ø§Ù„Ø­Ø¬Ù… Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù†Ø§ÙØ°Ø©
        window.addEventListener('resize', onWindowResize, false);
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // 9. Ø§Ù„ØªØ±Ø¬Ù…Ø© (Localization Logic)
        const translations = {
            en: { title: "Upload your photo to space!", btnUp: "ğŸ“‚ Upload Photo", btnDown: "ğŸ“¸ Download High Res" },
            ar: { title: "Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ Ø¥Ù„Ù‰ Ø§Ù„ÙØ¶Ø§Ø¡!", btnUp: "ğŸ“‚ Ø±ÙØ¹ ØµÙˆØ±Ø©", btnDown: "ğŸ“¸ ØªØ­Ù…ÙŠÙ„ Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©" },
            fr: { title: "TÃ©lÃ©chargez votre photo dans l'espace!", btnUp: "ğŸ“‚ TÃ©lÃ©charger", btnDown: "ğŸ“¸ Enregistrer" },
            // Ø£Ø¶Ù Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù„ØºØ§Øª Ù‡Ù†Ø§
        };

        function changeLanguage() {
            const lang = document.getElementById('language-selector').value;
            const t = translations[lang] || translations['en'];
            
            document.getElementById('instruction-text').innerText = t.title;
            document.getElementById('upload-btn').innerText = t.btnUp;
            document.getElementById('download-btn').innerText = t.btnDown;
            
            // ØªØ¹Ø¯ÙŠÙ„ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Øµ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©
            if(lang === 'ar') {
                document.body.style.direction = 'rtl';
            } else {
                document.body.style.direction = 'ltr';
            }
        }
    </script>
</body>
</html>
